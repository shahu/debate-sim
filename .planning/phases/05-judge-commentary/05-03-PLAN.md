---
phase: 05-judge-commentary
plan: 03
type: execute
wave: 3
depends_on: ["05-02"]
files_modified:
  - src/components/DebateDashboard.tsx
  - src/store/debateStore.ts
autonomous: false

must_haves:
  truths:
    - "Post-debate automatically displays judge commentary when debate completes"
    - "Users can view numerical scores and narrative feedback for each speaker"
    - "Side-by-side comparison panel shows all four speakers' evaluations"
  artifacts:
    - path: "src/components/DebateDashboard.tsx"
      provides: "Integration point for judge commentary display"
      contains: "Conditional rendering of judge scorecard"
    - path: "src/store/debateStore.ts"
      provides: "State management for judge evaluation"
      contains: "judgeEvaluation property and methods"
  key_links:
    - from: "src/store/debateStore.ts"
      to: "src/lib/scoringSystem.ts"
      via: "calls scoring function"
      pattern: "analyzeDebateTranscript"
    - from: "src/components/DebateDashboard.tsx"
      to: "src/store/debateStore.ts"
      via: "reads judge evaluation state"
      pattern: "useDebateStore.*judge"
    - from: "src/components/DebateDashboard.tsx"
      to: "src/components/judge/JudgeScorecard.tsx"
      via: "renders judge component"
      pattern: "<JudgeScorecard"
---

<objective>
Integrate the judge commentary system into the main debate flow. This plan connects the scoring logic and UI components to automatically display post-debate evaluation when the debate completes, fulfilling the requirement for post-debate scoring and feedback.

Purpose: Automatically show judge commentary when debate concludes
Output: Integrated system that displays scoring and feedback after debate completion
</objective>

<execution_context>
@~/.config/opencode/get-shit-done/workflows/execute-plan.md
@~/.config/opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/05-judge-commentary/05-CONTEXT.md
@.planning/phases/05-judge-commentary/05-RESEARCH.md
@src/types/judge.ts
@src/lib/scoringSystem.ts
@src/components/judge/JudgeScorecard.tsx
@src/store/debateStore.ts
@src/components/DebateDashboard.tsx
</context>

<tasks>

<task type="auto">
  <name>Update Debate Store with Judge State</name>
  <files>src/store/debateStore.ts</files>
  <action>
Modify the debate store to include judge evaluation functionality:
- Add judgeEvaluation property to DebateState interface and initial state
- Add generateJudgeEvaluation action that calls scoringSystem.analyzeDebateTranscript()
- Modify endDebate action to automatically call generateJudgeEvaluation when debate completes
- Add resetJudgeEvaluation action to clear evaluation when debate resets
- Ensure judge evaluation is generated from the final transcript when debate ends
- Include proper TypeScript typing for judge evaluation state
</action>
  <verify>Verify that ending a debate triggers evaluation generation and stores it in state</verify>
  <done>Debate store manages judge evaluation state and generates it when debate completes</done>
</task>

<task type="auto">
  <name>Integrate Judge Commentary into Dashboard</name>
  <files>src/components/DebateDashboard.tsx</files>
  <action>
Update the DebateDashboard to display judge commentary when debate completes:
- Import JudgeScorecard component
- Add conditional rendering to show JudgeScorecard when debate status is 'completed' and judgeEvaluation exists
- Hide other debate elements (timer, speaker indicator, controls) when judge commentary is displayed
- Show both transcript panel and judge commentary side by side or in tabs
- Maintain audio controls visibility during judge commentary
- Update the status indicator to reflect availability of judge commentary
- Preserve the motion display during judge commentary
- Ensure proper layout when switching between active debate and completed state with judge feedback
</action>
  <verify>When debate completes, judge commentary automatically appears in the UI</verify>
  <done>Completed debates automatically display judge commentary in the dashboard</done>
</task>

</tasks>

<verification>
Verify that completing a debate automatically triggers judge evaluation generation and displays the judge commentary UI.
</verification>

<success_criteria>
- Debate completion automatically triggers judge evaluation
- Judge commentary UI appears when debate completes
- All four speakers' scores and feedback displayed in side-by-side panels
- System integrates scoring logic with UI components seamlessly
- Users see both numerical scores and narrative feedback after debate ends
</success_criteria>

<output>
After completion, create `.planning/phases/05-judge-commentary/05-03-SUMMARY.md`
</output>