---
phase: 02-ui-experience
plan: 02
type: execute
wave: 2
depends_on: ["02-01"]
files_modified:
  - src/components/DebateControls.tsx
  - src/components/DebateFlowIndicator.tsx
  - src/components/DebateDashboard.tsx
  - src/styles/animations.css
autonomous: true

must_haves:
  truths:
    - "User can click Pause to pause the debate"
    - "User can click Resume to continue a paused debate"
    - "User can click Restart to reset the debate"
    - "User sees visual progress through debate phases (PM -> LO -> MO -> PW)"
    - "Transitions between speakers are smooth, not jarring"
  artifacts:
    - path: "src/components/DebateControls.tsx"
      provides: "Pause/Resume/Restart control buttons"
      exports: ["DebateControls"]
    - path: "src/components/DebateFlowIndicator.tsx"
      provides: "Visual progress indicator showing debate phases"
      exports: ["DebateFlowIndicator"]
    - path: "src/styles/animations.css"
      provides: "CSS transitions and animations for smooth updates"
      contains: "@keyframes"
  key_links:
    - from: "src/components/DebateControls.tsx"
      to: "src/store/debateStore.ts"
      via: "pauseDebate, resumeDebate, resetDebate actions"
      pattern: "pauseDebate|resumeDebate|resetDebate"
    - from: "src/components/DebateFlowIndicator.tsx"
      to: "src/store/debateStore.ts"
      via: "currentSpeakerIndex, speakingSequence"
      pattern: "currentSpeakerIndex|speakingSequence"
---

<objective>
Implement debate control buttons and visual flow indicators with smooth transitions.

Purpose: Enables user control over debate flow (UI-04), shows debate progress (UI-06), and adds smooth transitions (UI-03).
Output: Working controls for pause/restart, visual progress indicator, and CSS animations for smooth updates.
</objective>

<execution_context>
@~/.config/opencode/get-shit-done/workflows/execute-plan.md
@~/.config/opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/02-ui-experience/02-01-SUMMARY.md

# Existing source files
@src/store/debateStore.ts
@src/lib/constants.ts
@src/components/DebateDashboard.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create Debate Control Buttons Component</name>
  <files>
    - src/components/DebateControls.tsx
    - src/components/DebateDashboard.tsx
  </files>
  <action>
    Create control buttons for pause/resume/restart functionality (UI-04):
    
    1. **src/components/DebateControls.tsx**:
       - Import useDebateStore and extract: status, pauseDebate, resumeDebate, resetDebate
       - Create button group with three buttons:
       
       **Pause Button**:
       - Icon: Pause symbol (use text "⏸" or simple CSS square icons)
       - Visible when status === 'active'
       - onClick calls pauseDebate()
       - Styling: bg-yellow-500 hover:bg-yellow-600, white text, rounded, px-4 py-2
       
       **Resume Button**:
       - Icon: Play symbol (use text "▶")
       - Visible when status === 'paused'
       - onClick calls resumeDebate()
       - Styling: bg-green-500 hover:bg-green-600, white text, rounded
       
       **Restart Button**:
       - Icon: Reset symbol (use text "↺")
       - Always visible when status !== 'idle'
       - onClick calls resetDebate()
       - Styling: bg-red-500 hover:bg-red-600, white text, rounded
       - Add confirm dialog: window.confirm("Are you sure you want to restart the debate?")
       
       **Layout**:
       - Flex row with gap-2
       - Buttons have consistent sizing (min-w-24)
       - Disabled state styling: opacity-50, cursor-not-allowed
       - Add accessible labels (aria-label)
    
    2. Update **src/components/DebateDashboard.tsx**:
       - Import DebateControls
       - Add DebateControls below TimerDisplay
       - Center controls in the layout
  </action>
  <verify>
    Run `npm run dev`:
    - Buttons render when debate is active/paused
    - Pause button shows during active, Resume shows during paused
    - Clicking buttons updates store status
    - Test in browser: manually set store to 'active' and verify button visibility
    - TypeScript: `npx tsc --noEmit`
  </verify>
  <done>
    Control buttons available for pause/restart functionality (UI-04 complete).
    Buttons properly wired to store actions.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create Debate Flow Indicator Component</name>
  <files>
    - src/components/DebateFlowIndicator.tsx
    - src/components/DebateDashboard.tsx
  </files>
  <action>
    Create visual progress indicator showing debate flow (UI-06):
    
    1. **src/components/DebateFlowIndicator.tsx**:
       - Import useDebateStore: currentSpeakerIndex, speakingSequence, status
       - Import SPEAKER_ROLES, ROLE_DESCRIPTIONS from constants
       - Import speaker color CSS variables
       
       **Layout**: Horizontal stepper/progress bar showing all 4 speakers:
       
       ```
       [PM] ──── [LO] ──── [MO] ──── [PW]
        ●         ○         ○         ○
       ```
       
       **For each speaker step**:
       - Circle indicator with role abbreviation
       - Current speaker: filled circle with role color, scale(1.2), shadow
       - Completed speakers: filled circle, slightly muted
       - Upcoming speakers: outline circle, gray
       - Connector lines between circles
       
       **Visual States**:
       - Idle: All circles gray/outline
       - Active on PM: PM filled blue, others outline
       - Active on LO: PM muted filled, LO filled red, MO/PW outline
       - Completed: All filled in muted colors
       
       **Implementation**:
       - Map over speakingSequence
       - Compare index to currentSpeakerIndex for state
       - Use role colors from CSS variables
       - Add role name tooltip on hover (title attribute)
       - Responsive: stack vertically on mobile (sm:flex-row flex-col)
    
    2. Update **src/components/DebateDashboard.tsx**:
       - Import DebateFlowIndicator
       - Add DebateFlowIndicator at the top of dashboard (before SpeakerIndicator)
       - Add appropriate spacing
  </action>
  <verify>
    Run `npm run dev`:
    - Flow indicator shows all 4 speakers (PM, LO, MO, PW)
    - Current speaker is highlighted
    - Colors match role colors (blue, red, orange, green)
    - Responsive layout works on mobile viewport
    - TypeScript: `npx tsc --noEmit`
  </verify>
  <done>
    Visual indicators show debate flow and current phase (UI-06 complete).
    Users can see progress through PM -> LO -> MO -> PW sequence.
  </done>
</task>

<task type="auto">
  <name>Task 3: Add Smooth Transitions and Animations</name>
  <files>
    - src/styles/animations.css
    - src/main.tsx
    - src/components/SpeakerIndicator.tsx
    - src/components/SpeakerCard.tsx
    - src/components/DebateFlowIndicator.tsx
  </files>
  <action>
    Add CSS animations for smooth real-time updates (UI-03):
    
    1. **src/styles/animations.css**:
       ```css
       /* Fade in for new content */
       @keyframes fadeIn {
         from { opacity: 0; transform: translateY(10px); }
         to { opacity: 1; transform: translateY(0); }
       }
       
       /* Pulse for timer warning */
       @keyframes pulse {
         0%, 100% { opacity: 1; }
         50% { opacity: 0.7; }
       }
       
       /* Slide in for new transcript entries */
       @keyframes slideIn {
         from { opacity: 0; transform: translateX(-20px); }
         to { opacity: 1; transform: translateX(0); }
       }
       
       /* Scale pop for speaker changes */
       @keyframes speakerPop {
         0% { transform: scale(0.9); opacity: 0.5; }
         50% { transform: scale(1.05); }
         100% { transform: scale(1); opacity: 1; }
       }
       
       /* Utility classes */
       .animate-fade-in { animation: fadeIn 0.3s ease-out; }
       .animate-slide-in { animation: slideIn 0.4s ease-out; }
       .animate-speaker-pop { animation: speakerPop 0.3s ease-out; }
       .animate-pulse-warning { animation: pulse 1s ease-in-out infinite; }
       .animate-pulse-critical { animation: pulse 0.5s ease-in-out infinite; }
       
       /* Smooth transitions */
       .transition-speaker { transition: all 0.3s ease-out; }
       .transition-colors { transition: background-color 0.3s, border-color 0.3s, color 0.3s; }
       ```
    
    2. Import animations.css in **src/main.tsx** (after Tailwind import)
    
    3. Update **src/components/SpeakerIndicator.tsx**:
       - Add `animate-speaker-pop` class when speaker changes
       - Use key prop with currentSpeaker to trigger animation on change
       - Add `transition-colors` for smooth color transitions
    
    4. Update **src/components/SpeakerCard.tsx**:
       - Add `animate-slide-in` class to each card
       - Stagger animations for multiple cards using inline style animation-delay
    
    5. Update **src/components/DebateFlowIndicator.tsx**:
       - Add `transition-all duration-300` to step circles
       - Scale current speaker step: `transform scale-110`
       - Add subtle shadow to current step
    
    6. Update **src/components/TimerDisplay.tsx** (if not already done):
       - Apply `animate-pulse-warning` when 30-60s remaining
       - Apply `animate-pulse-critical` when <30s remaining
  </action>
  <verify>
    Run `npm run dev`:
    - Speaker changes animate smoothly (pop effect)
    - New transcript entries slide in
    - Timer pulses when time is low
    - Flow indicator transitions smoothly between states
    - No janky/jarring visual updates
    - CSS animates at 60fps (check Chrome DevTools Performance)
  </verify>
  <done>
    Real-time display updates with smooth transitions (UI-03 complete).
    All UI updates feel polished and responsive.
  </done>
</task>

</tasks>

<verification>
After all tasks complete:
1. Pause/Resume/Restart buttons work correctly
2. Flow indicator shows current phase accurately
3. All transitions are smooth (no jarring updates)
4. Animations play at 60fps
5. TypeScript compilation passes: `npx tsc --noEmit`
6. Test full flow: Start debate -> Pause -> Resume -> Restart
</verification>

<success_criteria>
- UI-03: Real-time display updates with smooth transitions
- UI-04: Control buttons available for pause/restart functionality
- UI-06: Visual indicators show debate flow and current phase
- All animations performant (60fps)
- Controls properly wired to store actions
</success_criteria>

<output>
After completion, create `.planning/phases/02-ui-experience/02-02-SUMMARY.md`
</output>
