---
phase: 01-core-mechanics
plan: 01
type: execute
wave: 1
depends_on: []
files_modified: 
  - src/types/debate.ts
  - src/lib/constants.ts
  - src/hooks/useDebateTimer.ts
  - src/lib/debateRules.ts
autonomous: true
user_setup: []

must_haves:
  truths:
    - "User can define a debate motion in 'This House believes that...' format"
    - "System enforces CPDL format with 4 distinct roles (PM, LO, MO, PW)"
    - "System enforces timing for each role (PM: 7min, LO: 8min, MO: 4min, PW: 4min)"
    - "Role-specific rules are enforced (LO challenges PM definition, MO/PW can't introduce new arguments)"
  artifacts:
    - path: "src/types/debate.ts"
      provides: "Debate state types and interfaces"
      contains: "DebateState, SpeakerRole, DebateTimer types"
    - path: "src/lib/constants.ts"
      provides: "Timing constants and role configurations"
      contains: "SPEAKER_ROLES, DEFAULT_TIMERS"
    - path: "src/hooks/useDebateTimer.ts"
      provides: "Timer functionality for debate roles"
      min_lines: 50
    - path: "src/lib/debateRules.ts"
      provides: "Rule enforcement logic for CPDL format"
      min_lines: 30
  key_links:
    - from: "src/hooks/useDebateTimer.ts"
      to: "src/lib/constants.ts"
      via: "import timer constants"
      pattern: "import.*DEFAULT_TIMERS"
    - from: "src/lib/debateRules.ts"
      to: "src/types/debate.ts"
      via: "use type definitions"
      pattern: "import.*DebateState"

---

<objective>
Establish the foundational debate mechanics including motion handling, CPDL format enforcement, timing controls, and core data structures. This plan creates the basic types, constants, and utilities needed for the debate system to function.

Purpose: Create the core infrastructure that enables debate mechanics and rule enforcement
Output: Type definitions, constants, timer hook, and rule enforcement utilities
</objective>

<execution_context>
@~/.config/opencode/get-shit-done/workflows/execute-plan.md
@~/.config/opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create Debate Type Definitions</name>
  <files>src/types/debate.ts</files>
  <action>Create comprehensive type definitions for the debate system:
- DebateState interface with motion, currentSpeaker, timeRemaining, speakers, transcript
- SpeakerRole enum with PM, LO, MO, PW values
- Speaker interface with id, name, role, speakingTime
- DebateTranscriptEntry interface with speaker, content, timestamp, poi flag
- DebateTimer interface with timeRemaining, isRunning, startTime, onPause, onResume methods</action>
  <verify>File exists and contains all defined types with proper TypeScript syntax</verify>
  <done>Valid TypeScript type definitions exist for all debate-related entities</done>
</task>

<task type="auto">
  <name>Task 2: Create Constants and Configuration</name>
  <files>src/lib/constants.ts</files>
  <action>Create constants file with:
- SPEAKER_ROLES array containing ['PM', 'LO', 'MO', 'PW'] in correct order
- DEFAULT_TIMERS object mapping each role to its time allocation (PM: 420, LO: 480, MO: 240, PW: 240 seconds)
- PROTECTED_TIME_START and PROTECTED_TIME_END constants (1st minute and last minute for POIs)
- DEBATE_MOTION_REGEX for validating "This House believes that..." format
- ROLE_DESCRIPTIONS object mapping each role to its responsibilities</action>
  <verify>Constants file exists with all required constants defined</verify>
  <done>All debate-related constants are defined and accessible</done>
</task>

</tasks>

<verification>
- All type definitions compile without TypeScript errors
- Constants are properly exported and accessible to other modules
- Timer hook (when created in next task) can access DEFAULT_TIMERS constant
- Rule enforcement utilities can access ROLE_DESCRIPTIONS
</verification>

<success_criteria>
- Core debate types are defined in src/types/debate.ts
- Constants are properly defined in src/lib/constants.ts
- Both files export their contents correctly
- TypeScript compilation succeeds with no errors
- Next tasks can import and use these definitions
</success_criteria>

<output>
After completion, create `.planning/phases/01-core-mechanics/01-01-SUMMARY.md`
</output>